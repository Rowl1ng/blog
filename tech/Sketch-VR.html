
<!DOCTYPE>
<html lang="zh-cn" data-scribe-reduced-action-queue="true">
    <head>
        <meta content='Sketch VR Development Log - Rowl1ng|黑客与画家' name='title' />
        <meta content='Sketch VR Development Log - Rowl1ng|黑客与画家' name='og:title' />
        <title>Sketch VR Development Log</title>
        <!--<title>Sketch VR Development Log - Rowl1ng|黑客与画家</title>-->
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Sketch VR Development Log - Rowl1ng|黑客与画家</title>
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Sketch VR Development Log - Rowl1ng|黑客与画家">
<meta name="twitter:keywords"  content="Raw Materials  Devices:          Oculus Rift: headset + handset x 2 + sensor x 2      Dell desktop with Nvidia 1070 G..." property='og:description' />
<meta property="og:type" content="article">
<meta property="og:title" content="Sketch VR Development Log">
<!--<meta property="og:title" content="Sketch VR Development Log - Rowl1ng|黑客与画家">-->
<meta property="og:description" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="og:keywords"  content="Raw Materials  Devices:          Oculus Rift: headset + handset x 2 + sensor x 2      Dell desktop with Nvidia 1070 G..." property='og:description' />
<meta name="theme-Jekyll by Rowl1ng" content="#eb5055">
<link rel="icon" type="image/png" href="/blog/style/favicons/favicon.ico" />
<link href="/blog/style/favicons/favicon.ico" rel="shortcut icon" type="image/png">
<link rel="canonical" href="/blog/">
<link rel="alternate" type="application/rss+xml" title="Rowl1ng" href="/blog/feed.xml">
<meta charset="UTF-8">
<!--<link rel="manifest" href="/manifest.json">-->
<link rel="shortcut icon" href="/blog/style/favicons/favicon.ico" type="image/x-icon">
<meta name="keywords"  content="Raw Materials  Devices:          Oculus Rift: headset + handset x 2 + sensor x 2      Dell desktop with Nvidia 1070 G..." property='og:description' />
<meta name="description" content="nothing is more practicla than a good theory" />
<link href="https://cdn.bootcss.com/highlight.js/9.10.0/styles/xcode.min.css" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.css">

<link href="/blog/style/style-rowl1ng.css" rel="stylesheet">
<link href="/blog/style/tocbot.css" rel="stylesheet">


    <meta content='/blog/tech/Sketch-VR.html' property='og:url' />
    <meta content="VR Development" property='og:description' />
    <meta content="article" property="og:type" />


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-71226909-1', 'auto');
        ga('send', 'pageview');
    </script>


<header id="header" class="header bg-white">
    <div class="navbar-container">
        <a href="/blog" title="访问 Rowl1ng|黑客与画家" class="navbar-logo"> <img src="/blog/style/images/logo-rowl1ng.png" alt="Rowl1ng|黑客与画家"> </a>
        <div class="navbar-menu">
            
            <a href="/blog/tech">TECH</a>
            
            <a href="/blog/art">ART</a>
            
            <a href="/blog/book">BOOK</a>
            
            <a href="/blog/write">WRITE</a>
            
            <a href="/blog/archives">ARCHIVE</a>
            
            <a href="/blog/tags">TAGS</a>
            
            <a href="/blog/about">ABOUT</a>
            
        </div>
        <div class="navbar-search" onclick="">
            <span class="icon-search"></span>
            <form id="cb-search-btn" role="search">
                        <span class="search-box">
                             <input type="text" class="input" id="cb-search-content" required="true" placeholder="title label..." maxlength="30" autocomplete="off">
                        </span>
            </form>
        </div>
        <div class="navbar-mobile-menu" onclick="">
            <span class="icon-menu cross"><span class="middle"></span></span>
            <ul>
                
                <li><a href="/blog/tech">TECH</a></li>
                
                <li><a href="/blog/art">ART</a></li>
                
                <li><a href="/blog/book">BOOK</a></li>
                
                <li><a href="/blog/write">WRITE</a></li>
                
                <li><a href="/blog/archives">ARCHIVE</a></li>
                
                <li><a href="/blog/tags">TAGS</a></li>
                
                <li><a href="/blog/about">ABOUT</a></li>
                
            </ul>
        </div>
    </div>
</header>

    </head>
    <body class="" gtools_scp_screen_capture_injected="true">
        <div class="post-header-thumb bg-white}">
            <div class="post-header-thumb-op"></div>
            <div class="post-header-thumb">
                <div class="post-header-thumb-container">
                    <h1 class="post-title" itemprop="name headline">
                        Sketch VR Development Log</h1>
                    <div class="post-data">
                        <time datetime="2020-01-22 14:00:00" itemprop="datePublished">发布时间：2020-01-22 14:00:00</time>
                        <time datetime="2020-01-22 14:00:00" itemprop="datePublished">更新时间：2020-01-22 14:00:00</time>
                        <a href="/blog/tags#tech" title="访问 tech" data-hover="博客分类: tech">博客分类: tech</a>
                        <!--busuanzi-->
                        <script async src="/blog/js/busuanzi.pure.mini.js">
                        </script>
                        <span id="busuanzi_container_page_pv">
                          阅读次数: <span id="busuanzi_value_page_pv"></span>
                        </span>
                        <!--<a href="#read"> 阅读次数: comments</a>-->
                    </div>
                    <div class="post-tags">
                        
                            
                            
                                
                                <a href="/blog/tags#VR" title="访问VR" data-hover="VR">
                                    VR <span>(1)</span>
                                    
                                </a>
                                
                                <a href="/blog/tags#Unity" title="访问Unity" data-hover="Unity">
                                    Unity <span>(1)</span>
                                    
                                </a>
                                
                            
                            
                        
                    </div>
                </div>
            </div>
        </div>
        <article class="main-content post-page" itemscope itemtype="http://schema.org/Article">
            <div class="post-header">
                <h1 class="post-title" itemprop="name headline">
                    Sketch VR Development Log</h1>
                <div class="post-data">
                    <time datetime="2020-01-22 14:00:00" itemprop="datePublished">2020-01-22 14:00:00</time>
                </div>
            </div>
            <div id="post-content" class="post-content" itemprop="articleBody">
                <p class="post-tags">
                    
                        
                        
                            
                                <a href="/blog/tags#VR" title="访问VR" data-hover="VR">
                                    VR <span>(1)</span>
                                    
                                </a>
                            
                                <a href="/blog/tags#Unity" title="访问Unity" data-hover="Unity">
                                    Unity <span>(1)</span>
                                    
                                </a>
                            
                        
                        
                    
                </p>
                <h1 id="raw-materials">Raw Materials</h1>

<ul>
  <li>Devices:
    <ul>
      <li>Oculus Rift: headset + handset x 2 + sensor x 2</li>
      <li>Dell desktop with Nvidia 1070 GPU
        <ul>
          <li>System： Windows 10</li>
          <li>Development Software：Unity 2019.2.17f1 + Visual Studio 2019</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Language: C#</li>
</ul>

<p>Actually it is not only a sketch game. it can also be used for viewing 3D models (For example, VR online shopping for furnitures!). If you are inrerested, it can be further developed into a 3D prototyping tool after adding editing function.</p>

<h1 id="data-preparation">Data Preparation</h1>

<p>In this game, players need to sketch the outline of the reference model. So our first task is to prepare our reference dataset. Here I list two most commonly used dataset:</p>

<ul>
  <li>Modelnet40, which contains 12311 uniformly orientated <code class="language-plaintext highlighter-rouge">.off</code> format models from 40 categories,
    <ul>
      <li>To make them compatible with Unity and easy to use, I normalize these models first and then convert them to <code class="language-plaintext highlighter-rouge">.obj</code> format. The normalization is composed of two steps:
        <ol>
          <li>translate to origin</li>
          <li>scale to unit
Now we can assure that every model imported has the same origin and scale. Then I use <code class="language-plaintext highlighter-rouge">pyassimp</code> to save them as <code class="language-plaintext highlighter-rouge">.obj</code> file.</li>
        </ol>
      </li>
    </ul>
  </li>
  <li>ShapeNetCore v1: It contains 6778 <code class="language-plaintext highlighter-rouge">.obj</code> chair models.</li>
</ul>

<h1 id="how-to-draw-a-line-in-vr">How to draw a line in VR?</h1>

<p>The answer lies in the <code class="language-plaintext highlighter-rouge">PointLineManager.cs</code>. When pressing the trigger on your controller while moving it. The script will record the position of the controller and use it as new point of the line.</p>

<p>A basic implementation is to use <code class="language-plaintext highlighter-rouge">LineRenderer</code>. When player keep pressing the trigger we just keep adding new points to the current LineRenderer using the coordinate of contoller.</p>

<p>Another way is to use <code class="language-plaintext highlighter-rouge">MeshLineRenderer.cs</code>. Different form the former, it will create a new mesh which not only has vertices but also has triangle faces. So in this way you can save your sketch as obj while the <code class="language-plaintext highlighter-rouge">LineRenderer</code> which doesn’t have meshes can only be saved as .off file.</p>

<h1 id="basics-of-unity">Basics of Unity</h1>

<p>Unity has two modes: Editor &amp; Build. In my practice, I found some functions can only run normally inside Editor mode. For example,  <code class="language-plaintext highlighter-rouge">AssetDatabase</code> is from <code class="language-plaintext highlighter-rouge">UnityEditor</code> namespace which is unavailable in build version. Here is a <a href="https://stackoverflow.com/questions/40064746/the-type-or-namespace-name-unityeditor-could-not-be-found">Solution on StackOverflow</a>.</p>

<h2 id="scene">Scene</h2>

<p>If you create an Unity 3D project from scratch, you will start from a defaulted scene where you can create any gameobject you want. In this VR project, we hope to collect some settings before players start to sketch, so we add a 2D start scene before the VR scene.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<p>To select filepath and directory as saving path and model path, one choice is official FileDialog API <code class="language-plaintext highlighter-rouge">EditorUtility.OpenFilePanel</code> , but it can only be used in Editor mode. In build mode, we choose <code class="language-plaintext highlighter-rouge">StandaloneFileBrowser</code> Asset as substitute. You can search and import this asset in Unity asset store.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PlayerManager.save_dir = StandaloneFileBrowser.OpenFolderPanel("Select Save Folder", "", true)[0];

PlayerManager.namelist_path = StandaloneFileBrowser.OpenFilePanel("Open Namelist File", "", "txt", true)[0];

</code></pre></div></div>

<h2 id="gameobject">GameObject</h2>

<p>Unity has two “kinds” of gameobject: “Real” physical object &amp; “virtual” script. If you want your script to function during the game, you can create an <code class="language-plaintext highlighter-rouge">Empty Object</code> and bind your script to it through <code class="language-plaintext highlighter-rouge">Add Component</code>.</p>

<p>If you want to operate on other object in current script. you can use <code class="language-plaintext highlighter-rouge">GameObject.Find("the name of other object")</code></p>

<p>If you want to operate on other script in current script. you can use <code class="language-plaintext highlighter-rouge">MyObject.GetComponent&lt;YourScriptName&gt;()</code></p>

<h2 id="file-io">File I/O</h2>

<ol>
  <li>How to import .obj files into the game?</li>
</ol>

<p>Search for <a href="https://assetstore.unity.com/packages/tools/modeling/runtime-obj-importer-49547#reviews">Runtime OBJ Importer</a> in Asset Store. Remenber to read the Readme file: You must go to the “Graphics” tab on the right side of Unity Editor, and add “Standard (Specular Setup)” to the <code class="language-plaintext highlighter-rouge">always included shaders</code>. This will make your next build take a while</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>targetPath = "absolute path"
loadedObject = new OBJLoader().Load(targetPath);
</code></pre></div></div>

<p>Another way is to use <code class="language-plaintext highlighter-rouge">Resources.Load()</code> to load .obj file in build mode. In this case, all model files should lie in <code class="language-plaintext highlighter-rouge">/Resources</code> directory （You can put<code class="language-plaintext highlighter-rouge">/Resources</code> directory under any subdirectory of your project）. But I found some models are displayed abnormally in this method.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>targetpath = "path under Resources directory"
loadedObject = Instantiate(Resources.Load(targetPath) as GameObject);

</code></pre></div></div>

<ol>
  <li>How to save sketch?</li>
</ol>

<p>I implemented two methods to save sketch:</p>

<ul>
  <li>export whole multiple lines as single mesh file, which has both vertices and triangle meshes.</li>
  <li>save sketch as trajectory：.off file with points coordinate only.</li>
</ul>

<p>Meanwhile, we also save timestamps of strokes: a list of (x,y,z,timestamp)</p>

<p>In editor mode, it is defaulted to save 3 types of files: model+sketch, sketch, model. But in buld version, we only save sketch since meshes loaded by Resources is unallowed to be read or saved.</p>

<h3 id="worldposition-vs-localposition">WorldPosition vs. LocalPosition</h3>

<p>Since you are not sure the position you are processing is local or World position, the safest way is to transform them into world position first and then do whatever you want.</p>

<p>For example, I need to save vertices of both sketch and model in one single obj file. So, to make sure they share the same coordinate system I first convert their position into world position <code class="language-plaintext highlighter-rouge">wv</code> and then to relative position <code class="language-plaintext highlighter-rouge">rv</code>.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Vector3 wv = mf.transform.TransformDirection(lv);
Vector3 rv = space.transform.InverseTransformDirection(wv);
</code></pre></div></div>

<h1 id="vr-development-oculus-rift">VR development (Oculus Rift)</h1>

<p>Go to asset store and import <code class="language-plaintext highlighter-rouge">Oculus</code> asset.</p>

<p>Get input from controller:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>float RI = OVRInput.Get(OVRInput.Axis1D.SecondaryIndexTrigger); //IndexTrigger on right hand controller
bool undoX = OVRInput.GetDown(OVRInput.RawButton.X); //X button on left controller
</code></pre></div></div>

<p><img src="https://docs.unity3d.com/uploads/Main/OculusControllersTouchControllers.jpg" alt="此处输入图片的描述" /></p>

<p><a href="https://docs.unity3d.com/Manual/OculusControllers.html">More information about Input for Oculus</a></p>

<h2 id="vr-uis">VR UIs</h2>

<p>We can still use traditional <code class="language-plaintext highlighter-rouge">Canvas</code> inside VR. But to interact with canvas, mouse activity for 2D display should be replaced by <code class="language-plaintext highlighter-rouge">LaserPointer</code> for VR, which you can utilize easily by importing <code class="language-plaintext highlighter-rouge">UIHelper</code> prefab from Oculus Asset as a gameobject .</p>

<p>Tutorial: <a href="https://arvrjourney.com/how-to-build-vr-uis-with-unity-and-oculus-rift-part-2-69e31b32dd82">how to build vr uis with unity and oculus rift part 2</a></p>

<h2 id="grabrotate-objects">Grab/Rotate Objects</h2>

<p>Add <code class="language-plaintext highlighter-rouge">OVR Grabbable</code> script to the object with <code class="language-plaintext highlighter-rouge">Rigid</code> and <code class="language-plaintext highlighter-rouge">Collider</code> component that you want to manipulate. And you can use your handtrigger to grab and rotate them.</p>

<p>For example, in this game I put both sketch and model under the same parent gameobject <code class="language-plaintext highlighter-rouge">space</code>, which means I only need to add <code class="language-plaintext highlighter-rouge">OVR Grabbable</code> script to <code class="language-plaintext highlighter-rouge">space</code> to manipulate both the sketch and model.</p>

<h2 id="ovrcamerarig">OVRCameraRig</h2>

<p>The <code class="language-plaintext highlighter-rouge">OVRCameraRig</code> prefab from Oculus Asset contains the camera for VR and two hand controller gameobjects. You can customize any controller operation with it easily. In my case, I attached a ColorPicker to left-hand controller.</p>

<h1 id="other-functions">Other Functions</h1>

<ul>
  <li>ColorPicker: Modified from <code class="language-plaintext highlighter-rouge">SimpleColorPicker</code> Asset. Main modification is to transfer interaction from mouse drag to laserpoint drag, which is implemented in <code class="language-plaintext highlighter-rouge">Draggble.cs</code> under SimpleColorPicker/Script.</li>
  <li>CountDown: <code class="language-plaintext highlighter-rouge">CountDownScript</code></li>
</ul>

<h1 id="tutorials">Tutorials</h1>

<ul>
  <li><a href="https://www.youtube.com/channel/UCPJlesN59MzHPPCp0Lg8sLw">Making VR game in Unity</a></li>
  <li><a href="https://www.youtube.com/watch?v=eMJATZI0A7c">Unity VR Tutorial: How To Build Tilt Brush From Scratch</a></li>
  <li>Basics of 3D graphics: Details are listed in <a href="https://rowl1ng.com/MyWiki/computer-graphics/3d-model.html">my wiki</a>.</li>
</ul>

<h1 id="comments">Comments</h1>

<ul>
  <li>
    <p>Oculus’s development ecosystem is not friendly enough for beginners nowadays. Resources for steamVR seems better，at least it has more tutorials on youtube. But I finally returned to Oculus integration after having some input trouble with steamvr.</p>

  </li>
</ul>



                <p class="post-info">
                    本文由 <a href="/">Rowl1ng</a> 创作，采用 <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="external nofollow">知识共享署名4.0</a> 国际许可协议进行许可<br>本站文章除注明转载/出处外，均为本站原创或翻译，转载前请务必署名<br>本文会经常更新，最后编辑时间为:2020-01-22 14:00:00
                </p>

            </div>

            <div id="container"></div>

            <head>
<!-- <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script> -->
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>

</head>
<body>
<div id="comment"></div>
<script>
    new Valine({
        el:'#comment',
        appId:'idSgAyfHquCiszy8RhbdG3OA-MdYXbMMI',
        appKey:'3gBNM2wIUvW3rj940DTGckvX',
        notify:false,
        verify:false,
        placeholder:'在这里写评论'
    })
</script>
</body>
        </article>

        <footer class="footer bg-white">
    <div class="footer-social">
        <div class="footer-container clearfix">
            <div class="social-list">
                <!--<a class="social segmentfault" target="blank" href="https://segmentfault.com/u/rowl1ng" title="访问 LiberXue_Twitter" data-hover="Segmentfault">Segmentfault</a>-->
                <a class="social github" target="blank" href="https://github.com/rowl1ng" title="访问 Rowl1ng_Github" data-hover="GitHub">GitHub</a>
                <a class="social deviantart" target="blank" href="https://sixijinling.deviantart.com/" title="访问 Rowl1ng_deviantart" data-hover="deviantart">Deviantart</a>
                <a class="social bilibili" target="blank" href="https://space.bilibili.com/3556743/#!/index" title="访问 Rowl1ng_bilibili" data-hover="bilibili">bilibili</a>
                <!--<a class="social twitter" target="blank" href="http://twitter.com/rowl1ng" title="访问 LiberXue_Twitter" data-hover="Twitter">Twitter</a>-->
                <!--<a class="social stackoverflow" target="blank" href="https://stackoverflow.com/users/6902190/rowl1ng" title="访问 LiberXue_stackoverflow" data-hover="StackOverflow">StackOverflow</a>-->
                <a class="social douban" target="blank" href="https://www.douban.com/people/rowl1ng/" title="访问 Rowl1ng_douban" data-hover="douban">douban</a>
                <a class="social rss" target="blank" href="/feed.xml"title="访问 Rowl1ng_RSS" data-hover="RSS">RSS</a>
            </div>
        </div>
    </div>
    <div class="footer-meta">
        <div class="footer-container">
            <div class="meta-item meta-copyright">
                <div class="meta-copyright-info">
                    <a href="/" class="info-logo">
                        <img src="/blog/style/images/logo-rowl1ng.png"   title="访问 Rowl1ng_blog" data-hover="Rowl1ng_blog" alt="Rowl1ng_blog" /> </a>
                    <div class="info-text">
                        <p>Theme is <a href="http://rowl1ng.com/2017/08/03/Jekyllthemes.html" title="访问 Jekyll Rowl1ng主题"  data-hover="Jekyll Rowl1ng"target="_blank">Jekyll rowl1ng</a> by <a href="http://rowl1ng.com/about" target="_blank">Rowl1ng</a></p>
                        <p>Powered by <a href="/blog/tags/#Jekyll" title="Jekyll" data-hover="Jekyll" target="_blank" rel="nofollow">Jekyll</a></p>
                        <p>&copy; 2024 <a href="/feed.xml"  title="访问 Rowl1ng blog RSS" data-hover="Rowl1ng blog RSS">Rowl1ng blog RSS</a></p>
                        <p>
                            <span id="busuanzi_container_site_uv" style="display: inline">
                           本站 UV <a href="http://ibruce.info" target="_blank"><span id="busuanzi_value_site_uv"></span></a>
                            </span>
                            本站 PV <span id="busuanzi_container_site_pv" style="display: inline"></span>
                                <span id="busuanzi_value_site_pv"></span>
                        </p>
                        <!--<p>总计文章：篇</p>-->
                    </div>
                </div>
            </div>
            <div class="meta-item meta-posts">
                <h3 class="meta-title">置顶文章</h3>
                <!--置顶-->
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href=" /blog/tech/Sketch-VR.html" title="访问 Sketch VR Development Log" data-hover="Sketch VR Development Log">Sketch VR Development Log</a></li>
                
                
                
                
                
                
                
                <li><a href=" /blog/tech/faster-rcnn.html" title="访问 Detectron代码分析：从Faster R-CNN 到 Mask R-CNN" data-hover="Detectron代码分析：从Faster R-CNN 到 Mask R-CNN">Detectron代码分析：从Faster R-CNN 到 Mask R-CNN</a></li>
                
                
                
                
                
                
                
                
                
                <li><a href=" /blog/tech/chatbot.html" title="访问 基于Rasa_NLU的微信chatbot" data-hover="基于Rasa_NLU的微信chatbot">基于Rasa_NLU的微信chatbot</a></li>
                
                
                <!--置顶-->
            </div>
            <div class="meta-item meta-comments">
                <h3 class="meta-title">最新文章</h3>
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                    <li><a href=" /blog/book/English.html" title="访问 各种英语考试的经验" data-hover="各种英语考试的经验">各种英语考试的经验</a></li>
                <!---->
                
                <!---->
                
            </div>
        </div>
    </div>
</footer>
<script src="//cdn.bootcss.com/jquery/2.2.2/jquery.min.js"></script>
<script src="//cdn.bootcss.com/bootstrap-3-typeahead/4.0.2/bootstrap3-typeahead.js"></script>
<script src="/blog/search/js/cb-search.js"></script>
<script>
    $(function () {
        setTimeout(function () {
            $('code').removeClass('hljs');
            $('code').removeClass('language');
        }, 90);
    });
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
        <div id="directory-content" class="directory-content">
            <div id="directory" class="js-toc"></div>
        </div>

        <!-- <div id="directory-content" class="directory-content">
            <div id="directory"></div>
        </div> -->
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
        <script >lang=hljs.initHighlightingOnLoad();</script>
        
        <script>
            
            tocbot.init({
            // Where to render the table of contents.
            tocSelector: '.js-toc',
            // Where to grab the headings to build the table of contents.
            contentSelector: '.post-content',
            // Which headings to grab inside of the contentSelector element.
            headingSelector: 'h1, h2, h3',
            // For headings inside relative or absolute positioned containers within content.
            hasInnerContainers: false,
            fixedSidebarOffset: 'auto',
            // headingsOffset: 40,
            scrollSmooth: true,
            scrollSmoothOffset: 0
            });
        </script>
    </body>
</html>