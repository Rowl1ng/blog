
<!DOCTYPE>
<html lang="zh-cn" data-scribe-reduced-action-queue="true">
    <head>
        <meta content='肺部结节检测 - Rowl1ng|黑客与画家' name='title' />
        <meta content='肺部结节检测 - Rowl1ng|黑客与画家' name='og:title' />
        <title>肺部结节检测</title>
        <!--<title>肺部结节检测 - Rowl1ng|黑客与画家</title>-->
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>肺部结节检测 - Rowl1ng|黑客与画家</title>
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="肺部结节检测 - Rowl1ng|黑客与画家">
<meta name="twitter:keywords"  content="图像处理基础  origin：表示CT图像最边缘的坐标  sapcing：真实世界和像素的比例关系  统一spacing到0.5x0.5x0.5mm，也就是说96x96的patch对应现实中48x48mmm预处理阶段可能用到的包：fr..." property='og:description' />
<meta property="og:type" content="article">
<meta property="og:title" content="肺部结节检测">
<!--<meta property="og:title" content="肺部结节检测 - Rowl1ng|黑客与画家">-->
<meta property="og:description" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="og:keywords"  content="图像处理基础  origin：表示CT图像最边缘的坐标  sapcing：真实世界和像素的比例关系  统一spacing到0.5x0.5x0.5mm，也就是说96x96的patch对应现实中48x48mmm预处理阶段可能用到的包：fr..." property='og:description' />
<meta name="theme-Jekyll by Rowl1ng" content="#eb5055">
<link rel="icon" type="image/png" href="/style/favicons/favicon.ico" />
<link href="/style/favicons/favicon.ico" rel="shortcut icon" type="image/png">
<link rel="canonical" href="/">
<link rel="alternate" type="application/rss+xml" title="Rowl1ng" href="/feed.xml">
<meta charset="UTF-8">
<!--<link rel="manifest" href="/manifest.json">-->
<link rel="shortcut icon" href="/style/favicons/favicon.ico" type="image/x-icon">
<meta name="keywords"  content="图像处理基础  origin：表示CT图像最边缘的坐标  sapcing：真实世界和像素的比例关系  统一spacing到0.5x0.5x0.5mm，也就是说96x96的patch对应现实中48x48mmm预处理阶段可能用到的包：fr..." property='og:description' />
<meta name="description" content="nothing is more practicla than a good theory" />
<link href="https://cdn.bootcss.com/highlight.js/9.10.0/styles/xcode.min.css" rel="stylesheet">

<link href="/style/style-rowl1ng.css" rel="stylesheet">

    <meta content='/tech/luna.html' property='og:url' />
    <meta content="experience in the Tianchi Lung Nodule Detection Contest" property='og:description' />
    <meta content="article" property="og:type" />


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-71226909-1', 'auto');
        ga('send', 'pageview');
    </script>


<header id="header" class="header bg-white">
    <div class="navbar-container">
        <a href="/?rowl1ng" title="访问 Rowl1ng|黑客与画家" class="navbar-logo"> <img src="/style/images/logo-rowl1ng.png" alt="Rowl1ng|黑客与画家"> </a>
        <div class="navbar-menu">
            
            <a href="/tech">TECH</a>
            
            <a href="/art">ART</a>
            
            <a href="/book">BOOK</a>
            
            <a href="/write">WRITE</a>
            
            <a href="/mybook">WIKI</a>
            
            <a href="/NeuralFish">FISH</a>
            
            <a href="/archives">ARCHIVE</a>
            
            <a href="/tags">TAGS</a>
            
            <a href="/about">ABOUT</a>
            
        </div>
        <div class="navbar-search" onclick="">
            <span class="icon-search"></span>
            <form id="cb-search-btn" role="search">
                        <span class="search-box">
                             <input type="text" class="input" id="cb-search-content" required="true" placeholder="title label..." maxlength="30" autocomplete="off">
                        </span>
            </form>
        </div>
        <div class="navbar-mobile-menu" onclick="">
            <span class="icon-menu cross"><span class="middle"></span></span>
            <ul>
                
                <li><a href="/tech">TECH</a></li>
                
                <li><a href="/art">ART</a></li>
                
                <li><a href="/book">BOOK</a></li>
                
                <li><a href="/write">WRITE</a></li>
                
                <li><a href="/mybook">WIKI</a></li>
                
                <li><a href="/NeuralFish">FISH</a></li>
                
                <li><a href="/archives">ARCHIVE</a></li>
                
                <li><a href="/tags">TAGS</a></li>
                
                <li><a href="/about">ABOUT</a></li>
                
            </ul>
        </div>
    </div>
</header>

    </head>
    <body class="" gtools_scp_screen_capture_injected="true">
        <div class="post-header-thumb bg-white}">
            <div class="post-header-thumb-op"></div>
            <div class="post-header-thumb">
                <div class="post-header-thumb-container">
                    <h1 class="post-title" itemprop="name headline">
                        肺部结节检测</h1>
                    <div class="post-data">
                        <time datetime="2017-04-25 21:38:00" itemprop="datePublished">发布时间：2017-04-25 21:38:00</time>
                        <time datetime="2018-12-20 16:28:00" itemprop="datePublished">更新时间：2018-12-20 16:28:00</time>
                        <a href="/tags#tech" title="访问 tech" data-hover="博客分类: tech">博客分类: tech</a>
                        <!--busuanzi-->
                        <script async src="/js/busuanzi.pure.mini.js">
                        </script>
                        <span id="busuanzi_container_page_pv">
                          阅读次数: <span id="busuanzi_value_page_pv"></span>
                        </span>
                        <!--<a href="#read"> 阅读次数: comments</a>-->
                    </div>
                    <div class="post-tags">
                        
                            
                            
                                
                                <a href="/tags#医疗图像" title="访问医疗图像" data-hover="医疗图像">
                                    医疗图像 <span>(1)</span>
                                    
                                </a>
                                
                            
                            
                        
                    </div>
                </div>
            </div>
        </div>
        <article class="main-content post-page" itemscope itemtype="http://schema.org/Article">
            <div class="post-header">
                <h1 class="post-title" itemprop="name headline">
                    肺部结节检测</h1>
                <div class="post-data">
                    <time datetime="2017-04-25 21:38:00" itemprop="datePublished">2017-04-25 21:38:00</time>
                </div>
            </div>
            <div id="post-content" class="post-content" itemprop="articleBody">
                <p class="post-tags">
                    
                        
                        
                            
                                <a href="/tags#医疗图像" title="访问医疗图像" data-hover="医疗图像">
                                    医疗图像 <span>(1)</span>
                                    
                                </a>
                            
                        
                        
                    
                </p>
                <h1 id="图像处理基础">图像处理基础</h1>

<ul>
  <li><code class="highlighter-rouge">origin</code>：表示CT图像最边缘的坐标</li>
  <li><code class="highlighter-rouge">sapcing</code>：真实世界和像素的比例关系</li>
</ul>

<p><img src="http://upload-images.jianshu.io/upload_images/1156558-a483ffcb4ca3d4ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="此处输入图片的描述" /></p>

<ul>
  <li>统一spacing到0.5x0.5x0.5mm，也就是说96x96的patch对应现实中48x48mmm</li>
</ul>

<p>预处理阶段可能用到的包：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from skimage.segmentation import clear_border
from skimage.measure import label, regionprops
from skimage.filters import roberts, sobel
from scipy import ndimage as ndi
from mpl_toolkits.mplot3d.art3d import Poly3DCollection # 用于可视化3d图像
from skimage.morphology import ball, disk, dilation, binary_erosion, remove_small_objects, erosion, closing, reconstruction, binary_closing
</code></pre></div></div>
<h2 id="肺部区域分割">肺部区域分割</h2>

<p>参考<a href="https://www.kaggle.com/arnavkj95/candidate-generation-and-luna16-preprocessing/code">Candidate Generation and LUNA16 preprocessing
</a>可实现肺部区域的分割，从而为下一步提取3d cube做准备。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def segment_lung_from_ct_scan(ct_scan):
    return np.asarray([get_segmented_lungs(slice) for slice in ct_scan])

def get_segmented_lungs(im, plot=False):

    '''
    This funtion segments the lungs from the given 2D slice.
    '''
    if plot == True:
        f, plots = plt.subplots(8, 1, figsize=(5, 40))
    '''
    Step 1: Convert into a binary image.
    '''
    binary = im &lt; 200
    if plot == True:
        plots[0].axis('off')
        plots[0].imshow(binary, cmap=plt.cm.bone)
    '''
    Step 2: Remove the blobs connected to the border of the image.
    '''
    cleared = clear_border(binary)
    if plot == True:
        plots[1].axis('off')
        plots[1].imshow(cleared, cmap=plt.cm.bone)
    '''
    Step 3: Label the image.
    '''
    label_image = label(cleared)
    if plot == True:
        plots[2].axis('off')
        plots[2].imshow(label_image, cmap=plt.cm.bone)
    '''
    Step 4: Keep the labels with 2 largest areas.
    '''
    areas = [r.area for r in regionprops(label_image)]
    areas.sort()
    if len(areas) &gt; 2:
        for region in regionprops(label_image):
            if region.area &lt; areas[-2]:
                for coordinates in region.coords:
                       label_image[coordinates[0], coordinates[1]] = 0
    binary = label_image &gt; 0
    if plot == True:
        plots[3].axis('off')
        plots[3].imshow(binary, cmap=plt.cm.bone)
    '''
    Step 5: Erosion operation with a disk of radius 2. This operation is
    seperate the lung nodules attached to the blood vessels.
    '''
    selem = disk(2)
    binary = binary_erosion(binary, selem)
    if plot == True:
        plots[4].axis('off')
        plots[4].imshow(binary, cmap=plt.cm.bone)
    '''
    Step 6: Closure operation with a disk of radius 10. This operation is
    to keep nodules attached to the lung wall.
    '''
    selem = disk(10)
    binary = binary_closing(binary, selem)
    if plot == True:
        plots[5].axis('off')
        plots[5].imshow(binary, cmap=plt.cm.bone)
    '''
    Step 7: Fill in the small holes inside the binary mask of lungs.
    '''
    edges = roberts(binary)
    binary = ndi.binary_fill_holes(edges)
    if plot == True:
        plots[6].axis('off')
        plots[6].imshow(binary, cmap=plt.cm.bone)
    '''
    Step 8: Superimpose the binary mask on the input image.
    '''
#     get_high_vals = binary == 0
#     im[get_high_vals] = 0
#     if plot == True:
#         plots[7].axis('off')
#         plots[7].imshow(im, cmap=plt.cm.bone)

    return binary
</code></pre></div></div>
<p><img src="http://static.zybuluo.com/sixijinling/gl9og6z21zzipkk90fsjitdy/image_1cdrhtvlq1v291i8a1ah217faiu89.png" alt="image_1cdrhtvlq1v291i8a1ah217faiu89.png-83kB" /></p>

<p>可视化3d肺部分割</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def plot_3d(image, threshold=-300):
    from skimage import measure, feature

    # Position the scan upright,
    # so the head of the patient would be at the top facing the camera
    p = image.transpose(2,1,0)
    p = p[:,:,::-1]

#     print measure.marching_cubes(p, threshold)
    verts, faces, _, _= measure.marching_cubes(p, threshold)

    fig = plt.figure(figsize=(10, 10))
    ax = fig.add_subplot(111, projection='3d')

    # Fancy indexing: `verts[faces]` to generate a collection of triangles
    mesh = Poly3DCollection(verts[faces], alpha=0.1)
    face_color = [0.5, 0.5, 1]
    mesh.set_facecolor(face_color)
    ax.add_collection3d(mesh)

    ax.set_xlim(0, p.shape[0])
    ax.set_ylim(0, p.shape[1])
    ax.set_zlim(0, p.shape[2])

    plt.show()
</code></pre></div></div>

<p><img src="http://static.zybuluo.com/sixijinling/e5wzvf8xqvmdu9hl73xkh0b0/image_1cdri1e721nbp1c7k1ve5nu2tpd1m.png" alt="image_1cdri1e721nbp1c7k1ve5nu2tpd1m.png-134.4kB" /></p>

<p>去除假阳性</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>selem = ball(10)
binary = binary_opening(segmented_ct_scan, selem)

label_scan = label(binary)

areas = [r.area for r in regionprops(label_scan)] # 找连通区域
areas.sort()
print areas
</code></pre></div></div>
<p><img src="http://static.zybuluo.com/sixijinling/qbtrueqt9qagfxkd0opwblcc/image_1cdri1qfm19g6t1e1bbg13441a3e23.png" alt="image_1cdri1qfm19g6t1e1bbg13441a3e23.png-128kB" /></p>

<p>提取3d cube作为inference输入，所有cube的可视化：</p>

<p><img src="http://static.zybuluo.com/sixijinling/tqmuwhoyh6eu3sszw55ckjfi/image_1cdrljm251gjg108t17fj1eit1bb92g.png" alt="image_1cdrljm251gjg108t17fj1eit1bb92g.png-149.5kB" /></p>

<p>差一步normalize到相同pixel spacing的过程：</p>

<p><img src="http://static.zybuluo.com/sixijinling/tdqvxjb59e1p5jfxo2dykw88/image_1ce5gjlu619aq325k941e6o14p29.png" alt="image_1ce5gjlu619aq325k941e6o14p29.png-142.7kB" /></p>

<p>检查：</p>

<p><img src="http://static.zybuluo.com/sixijinling/cv3ice16g6d1cir64spqbjum/image_1ce6iegtia0mjhs46f1q3n1e1e9.png" alt="image_1ce6iegtia0mjhs46f1q3n1e1e9.png-16.5kB" /></p>

<h1 id="模型">模型</h1>

<p>考虑到3d场景下做目标检测的计算量，通常分两个阶段，先筛出可疑对象，再筛掉假阳性：</p>

<h2 id="stage-1candidates-proposal">Stage 1：Candidates Proposal</h2>
<p>这个阶段的任务是尽可能找出所有可能是结节的候选（candidate）</p>

<h3 id="思路1segmentation">思路1：Segmentation</h3>

<p>例如U-net，</p>

<h4 id="merge-candidates">Merge Candidates</h4>

<p>先腐蚀，再算连通性，再取label，每个label代表一个candidate，取mass中心，存储为csv
对照annotations.csv得到每个candidate的是TP还是FP的label，得到新的csv（最后一列为true/false的标记）
欧式距离</p>

<h3 id="思路2-object-detection">思路2: Object Detection</h3>

<p>例如Faster RCNN，使用2D模型处理3D检测问题，例如每个通道代表z轴的一个slice，这样就有3个slice组成的3通道二维图像，即形如<script type="math/tex">600\times 600 \times 3</script>的image。每个通道可以是相邻的slice。</p>

<p>需要注意的是：考虑到肺结节的尺度比常规的自然图像中的物体要小得多，而原始的Faster RCNN使用的是16倍降采样（VGG-16Net的前四个卷积group作为feature extraction），需要通过减小降采样的方式提升ROI检测的效果。有两种思路：</p>

<ol>
  <li>减少feature extractor的maxpooling层：例如删掉某个group中的maxpooling</li>
  <li>在feature extractor最后增加deconvolutional layer：例如 <code class="highlighter-rouge">nn.ConvTranspose2d(1024, 1024, 4, 4, 4)</code>会上采样4倍，这样最终是降采样4倍</li>
</ol>

<p>另一个相伴相生的问题：标注的大小。normalize之后的结节标注可能只有1个像素大小（可能是医生标注的问题），这样即使是4倍下采样也达不到检出效果。我的方案是中心不变、扩大到8个像素。</p>

<h4 id="rpn">RPN</h4>

<ul>
  <li>input：image;</li>
  <li>output：一系列矩形框，代表ROI，每个框都有一个objectness score，代表是物体的概率。</li>
</ul>

<h2 id="stage2false-positive--reduction">Stage2：False Positive  Reduction</h2>

<h3 id="2d-resnet">2D Resnet</h3>

<p>可参考<a href="https://github.com/gzuidhof/luna16">LUNA16 Lung Nodule Analysis</a></p>

<p>First we equalize the spacings tp 0.5mm0.5mm0.5mm using src/data_processing/equalize_spacings.py. Then we create the 96x96 patches in all three orientations using src/data_processing/create_xy_xz_yz_CARTESIUS.py. Scripts to perform this using SLURM for job management (will require some editing of paths) can be found in /scripts/create_patches/ and /scripts/rescale</p>

<ul>
  <li>取三个轴向的切面(patch)，根据candidate的label存储在true/false文件夹下</li>
</ul>

<h3 id="3d-conv">3d conv</h3>

<p>由于ct是三维的，考虑使用常见的2d U-net的3d版本。</p>

<p>可参考：</p>

<ul>
  <li><a href="https://www.kaggle.com/c/data-science-bowl-2017/details/tutorial">U-Net Segmentation Approach to Cancer Diagnosis</a></li>
  <li>在luna上的3dconv的unet实现：<a href="https://github.com/Wrosinski/Kaggle-DSB/blob/master/LUNA/models/U-Net%203D/3DUNet_train_generator.py">Kaggle U-net</a></li>
  <li>keras 提供的<a href="https://keras-cn.readthedocs.io/en/latest/layers/convolutional_layer/">conv3d</a>：</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>keras.layers.convolutional.Conv3D(
    filters, # 卷积核的数目（即输出的维度）
    kernel_size, # 单个整数或由3个整数构成的list/tuple，卷积核的宽度和长度。如为单个整数，则表示在各个空间维度的相同长度。
    strides=(1, 1, 1),
    padding='valid',
    data_format=None,
    dilation_rate=(1, 1, 1),
    activation=None,
    use_bias=True,
    kernel_initializer='glorot_uniform',
    bias_initializer='zeros',
    kernel_regularizer=None,
    bias_regularizer=None,
    activity_regularizer=None,
    kernel_constraint=None,
    bias_constraint=None)
</code></pre></div></div>

<p>三维卷积对三维的输入进行滑动窗卷积，当使用该层作为第一层时，应提供input_shape参数。例如input_shape = (3,10,128,128)代表对10帧128*128的彩色RGB图像进行卷积。数据的通道位置仍然有data_format参数指定。</p>

<p>输入shape</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">‘channels_first’</code>模式下，输入应为形如<code class="highlighter-rouge">（samples，channels，input_dim1，input_dim2, input_dim3）</code>的5D张量</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">‘channels_last’</code>模式下，输入应为形如<code class="highlighter-rouge">（samples，input_dim1，input_dim2, input_dim3，channels）</code>的5D张量</p>
  </li>
</ul>

<p>这里的输入shape指的是函数内部实现的输入shape，而非函数接口应指定的input_shape。</p>

<h1 id="评价指标">评价指标</h1>

<p><a href="https://luna16.grand-challenge.org/evaluation/">Luna官方说明</a>：The evaluation is performed by measuring the detection sensitivity of the algorithm and the corresponding false positive rate per scan.</p>

<ul>
  <li>TP判定（hit criterion）：candidate必须是在standard reference 中以nodule center为中心的半径R（结节直径除2）之内。hit到一个正例之后就将这个例子从表中除去，保证不重复计数。也就是说，又有第二个预测点hit到这个结节时就被忽略，不算TP。</li>
  <li>FP判定：在设定的半径距离内没有hit到任何reference结节.</li>
  <li>忽略的情况：Candidates that are detecting irrelevant findings (see Data section in this page for definition) are ignored during the evaluation and are not considered either false positives or true positives.</li>
</ul>

<p>最终的分数是取7个横座标点对应的纵座标（TPR）均值：</p>

<ul>
  <li>横座标（FPR）： 1/8, 1/4, 1/2, 1, 2, 4, and 8 FPs per scan</li>
  <li>完美是1，最低是0. Most CAD systems in clinical use today have their internal threshold set to operate somewhere between 1 to 4 false positives per scan on average. Some systems allow the user to vary the threshold. To make the task more challenging, we included low false positive rates in our evaluation. This determines if a system can also identify a significant percentage of nodules with very few false alarms, as might be needed for CAD algorithms that operate more or less autonomously.</li>
</ul>

<p>论文里关于FROC的说明：</p>

<p>sensitivity是关于FPR平均值的函数：</p>

<p>This means that the sensitivity (y) is plotted as a function of the average number of false positive markers per scan ().</p>

<ul>
  <li>计算FROC曲线：阈值为t，概率p≥ t则判定为结节，由此计算TPR、FPR，得到曲线上的一个点。</li>
  <li>图像ID号（seriesuid）：发现结果所在的scan的名字。</li>
  <li>三维坐标：浮点数（用小数点，不要用逗号）。注意：我们提供的数据的第一个体素（voxel） 的坐标是 (-128.6,-175.3,-298.3). Coordinates are given in world coordinates or millimeters. You can verify if you use the correct way of addressing voxels by checking the supplied coordinates for the example data, the locations should refer to locations that hold a nodule.</li>
  <li>probability : 描述为真结节的可疑程度，浮点数。通过调节对它设定的<strong>阈值</strong>来计算 <strong>FROC曲线</strong>。</li>
</ul>

<p>Between the strings and the numbers should be a comma character. The order of the lines is irrelevant.</p>

<p>The following is an example result file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>seriesuid,coordX,coordY,coordZ,probability
LKDS_00001,75.5,56.0,-194.254518072,6.5243e-05
LKDS_00002,-35.5999634723,78.000078755,-13.3814265714,0.00269234
LKDS_00003,80.2837837838,198.881575673,-572.700012,0.00186072
LKDS_00004,-98.8499883785,33.6429184312,-99.7736607907,0.00035473
LKDS_00005,98.0667072477,-46.4666486536,-141.421980179,0.000256219

</code></pre></div></div>
<p>This file contains 8 findings (obviously way too few). There are 5 unique likelihood values. This means that there will be 5 unique thresholds that produce a distinct set of findings (each threshold discards finding below the threshold. That means there will be 5 points on the FROC curve.</p>

<p>It has to be noted that for the ‘false positive reduction’ challenge track, 551,065 findings (the amount of given candidates) are expected. The order of the lines is irrelevant.</p>


                <p class="post-info">
                    本文由 <a href="/">Rowl1ng</a> 创作，采用 <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="external nofollow">知识共享署名4.0</a> 国际许可协议进行许可<br>本站文章除注明转载/出处外，均为本站原创或翻译，转载前请务必署名<br>本文会经常更新，最后编辑时间为:2018-12-20 16:28:00
                </p>

            </div>
            <div id="container"></div>
            <head>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>

</head>
<body>
<div id="comment"></div>
<script>
    new Valine({
        el:'#comment',
        appId:'2YW66V1Vo5hgx2QQsLVUm9fI-gzGzoHsz',
        appKey:'98vOtLttcosk7VEGhhPlxExy',
        notify:false,
        verify:false,
        // path: '/post/jekyll-%E6%B7%BB%E5%8A%A0-Valine-%E8%AF%84%E8%AE%BA.html',
        placeholder:'在这里写评论'
    })
</script>
</body>
<!--<link rel="stylesheet" href="/css/gitment.css">-->
<!--<script src="/js/gitment.browser.js"></script>-->
<!--<script>-->
<!--var gitment = new Gitment({-->
<!--owner: 'Rowl1ng',-->
<!--repo: 'rowl1ng.github.io',-->
<!--oauth: {-->
<!--client_id: 'd3a4fe07f0e275a814af',-->
<!--client_secret: '568c448355abf329a831ea9e1cbcaf94dab7ce8b',-->
<!--},-->
<!--})-->
<!--gitment.render('container')-->
<!--</script>-->
        </article>
        <footer class="footer bg-white">
    <div class="footer-social">
        <div class="footer-container clearfix">
            <div class="social-list">
                <!--<a class="social segmentfault" target="blank" href="https://segmentfault.com/u/rowl1ng" title="访问 LiberXue_Twitter" data-hover="Segmentfault">Segmentfault</a>-->
                <a class="social github" target="blank" href="https://github.com/rowl1ng" title="访问 Rowl1ng_Github" data-hover="GitHub">GitHub</a>
                <a class="social deviantart" target="blank" href="https://sixijinling.deviantart.com/" title="访问 Rowl1ng_deviantart" data-hover="deviantart">Deviantart</a>
                <a class="social bilibili" target="blank" href="https://space.bilibili.com/3556743/#!/index" title="访问 Rowl1ng_bilibili" data-hover="bilibili">bilibili</a>
                <!--<a class="social twitter" target="blank" href="http://twitter.com/rowl1ng" title="访问 LiberXue_Twitter" data-hover="Twitter">Twitter</a>-->
                <!--<a class="social stackoverflow" target="blank" href="https://stackoverflow.com/users/6902190/rowl1ng" title="访问 LiberXue_stackoverflow" data-hover="StackOverflow">StackOverflow</a>-->
                <a class="social douban" target="blank" href="https://www.douban.com/people/rowl1ng/" title="访问 Rowl1ng_douban" data-hover="douban">douban</a>
                <a class="social rss" target="blank" href="/feed.xml"title="访问 Rowl1ng_RSS" data-hover="RSS">RSS</a>
            </div>
        </div>
    </div>
    <div class="footer-meta">
        <div class="footer-container">
            <div class="meta-item meta-copyright">
                <div class="meta-copyright-info">
                    <a href="/" class="info-logo">
                        <img src="/style/images/logo-rowl1ng.png"   title="访问 Rowl1ng_blog" data-hover="Rowl1ng_blog" alt="Rowl1ng_blog" /> </a>
                    <div class="info-text">
                        <p>Theme is <a href="http://rowl1ng.com/2017/08/03/Jekyllthemes.html" title="访问 Jekyll Rowl1ng主题"  data-hover="Jekyll Rowl1ng"target="_blank">Jekyll rowl1ng</a> by <a href="http://rowl1ng.com/about" target="_blank">Rowl1ng</a></p>
                        <p>Powered by <a href="/tags/#Jekyll" title="Jekyll" data-hover="Jekyll" target="_blank" rel="nofollow">Jekyll</a></p>
                        <p>&copy; 2019 <a href="/feed.xml"  title="访问 Rowl1ng blog RSS" data-hover="Rowl1ng blog RSS">Rowl1ng blog RSS</a></p>
                        <p>
                            <span id="busuanzi_container_site_uv" style="display: inline">
                           本站 UV <a href="http://ibruce.info" target="_blank"><span id="busuanzi_value_site_uv"></span></a>
                            </span>
                            本站 PV <span id="busuanzi_container_site_pv" style="display: inline"></span>
                                <span id="busuanzi_value_site_pv"></span>
                        </p>
                        <!--<p>总计文章：篇</p>-->
                    </div>
                </div>
            </div>
            <div class="meta-item meta-posts">
                <h3 class="meta-title">置顶文章</h3>
                <!--置顶-->
                
                
                
                
                <li><a href="/tech/faster-rcnn.html" title="访问 Detectron代码分析：从Faster R-CNN 到 Mask R-CNN" data-hover="Detectron代码分析：从Faster R-CNN 到 Mask R-CNN">Detectron代码分析：从Faster R-CNN 到 Mask R-CNN</a></li>
                
                
                
                
                
                
                
                
                
                <li><a href="/%E6%8A%80%E6%9C%AF/chatbot.html" title="访问 基于Rasa_NLU的微信chatbot" data-hover="基于Rasa_NLU的微信chatbot">基于Rasa_NLU的微信chatbot</a></li>
                
                
                
                
                
                
                
                
                
                <li><a href="/tech/phoneme.html" title="访问 基于音素识别的语音相似度研究" data-hover="基于音素识别的语音相似度研究">基于音素识别的语音相似度研究</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
                <!--置顶-->
            </div>
            <div class="meta-item meta-comments">
                <h3 class="meta-title">最新文章</h3>
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                    <li><a href="/%E5%AD%A6%E4%B9%A0/English.html" title="访问 各种英语考试的经验" data-hover="各种英语考试的经验">各种英语考试的经验</a></li>
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                
                <!---->
                    <li><a href="/book/Socialism.html" title="访问 《观念的水位》+《柏林墙》" data-hover="《观念的水位》+《柏林墙》">《观念的水位》+《柏林墙》</a></li>
                <!---->
                
                <!---->
                
                <!---->
                    <li><a href="/book/watch_TV.html" title="访问 爱好：看电视" data-hover="爱好：看电视">爱好：看电视</a></li>
                <!---->
                
            </div>
        </div>
    </div>
</footer>
<script src="//cdn.bootcss.com/jquery/2.2.2/jquery.min.js"></script>
<script src="//cdn.bootcss.com/bootstrap-3-typeahead/4.0.2/bootstrap3-typeahead.js"></script>
<script src="/search/js/cb-search.js"></script>
<script>
    $(function () {
        setTimeout(function () {
            $('code').removeClass('hljs');
            $('code').removeClass('language');
        }, 90);
    });
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
        <div id="directory-content" class="directory-content">
            <div id="directory"></div>
        </div>
        <script>
            var postDirectoryBuild = function() {
                var postChildren = function children(childNodes, reg) {
                    var result = [],
                        isReg = typeof reg === 'object',
                        isStr = typeof reg === 'string',
                        node, i, len;
                    for (i = 0, len = childNodes.length; i < len; i++) {
                        node = childNodes[i];
                        if ((node.nodeType === 1 || node.nodeType === 9) &&
                            (!reg ||
                                isReg && reg.test(node.tagName.toLowerCase()) ||
                                isStr && node.tagName.toLowerCase() === reg)) {
                            result.push(node);
                        }
                    }
                    return result;foot
                },
                createPostDirectory = function(article, directory, isDirNum) {
                    var contentArr = [],
                        titleId = [],
                        levelArr, root, level,
                        currentList, list, li, link, i, len;
                    levelArr = (function(article, contentArr, titleId) {
                        var titleElem = postChildren(article.childNodes, /^h\d$/),
                            levelArr = [],
                            lastNum = 1,
                            lastRevNum = 1,
                            count = 0,
                            guid = 1,
                            id = 'directory' + (Math.random() + '').replace(/\D/, ''),
                            lastRevNum, num, elem;
                        while (titleElem.length) {
                            elem = titleElem.shift();
                            contentArr.push(elem.innerHTML);
                            num = +elem.tagName.match(/\d/)[0];
                            if (num > lastNum) {
                                levelArr.push(1);
                                lastRevNum += 1;
                            } else if (num === lastRevNum ||
                                num > lastRevNum && num <= lastNum) {
                                levelArr.push(0);
                                lastRevNum = lastRevNum;
                            } else if (num < lastRevNum) {
                                levelArr.push(num - lastRevNum);
                                lastRevNum = num;
                            }
                            count += levelArr[levelArr.length - 1];
                            lastNum = num;
                            elem.id = elem.id || (id + guid++);
                            titleId.push(elem.id);
                        }
                        if (count !== 0 && levelArr[0] === 1) levelArr[0] = 0;
                        return levelArr;
                    })(article, contentArr, titleId);
                    currentList = root = document.createElement('ul');
                    dirNum = [0];
                    for (i = 0, len = levelArr.length; i < len; i++) {
                        level = levelArr[i];
                        if (level === 1) {
                            list = document.createElement('ul');
                            if (!currentList.lastElementChild) {
                                currentList.appendChild(document.createElement('li'));
                            }
                            currentList.lastElementChild.appendChild(list);
                            currentList = list;
                            dirNum.push(0);
                        } else if (level < 0) {
                            level *= 2;
                            while (level++) {
                                if (level % 2) dirNum.pop();
                                currentList = currentList.parentNode;
                            }
                        }
                        dirNum[dirNum.length - 1]++;
                        li = document.createElement('li');
                        link = document.createElement('a');
                        link.href = '#' + titleId[i];
                        link.title = '访问' + titleId[i];
                        link.title = '访问' + titleId[i];
                        link.innerHTML = !isDirNum ? contentArr[i] :
                            dirNum.join('.') + ' ' + contentArr[i] ;
                        li.appendChild(link);
                        currentList.appendChild(li);
                    }
                    directory.appendChild(root);
                };
                createPostDirectory(document.getElementById('post-content'),document.getElementById('directory'), true);
            };
            postDirectoryBuild();
        </script>
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
        <script >lang=hljs.initHighlightingOnLoad();</script>
        
        <!--<script type='text/javascript' -->
                <!--href='https://use.typekit.net/cwj3gfk.js'>-->
        <!--</script>-->
        <!--<script type='text/javascript'). try{Typekit.load({ async: true });}catch(e){}>-->
        <!--</script>-->
    </body>
</html>